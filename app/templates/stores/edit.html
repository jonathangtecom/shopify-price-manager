{% extends "base.html" %}
{% block title %}Edit {{ store.name }} - Shopify Price Manager{% endblock %}
{% block content %}
<div class="card" style="max-width: 600px;">
    <h2>Edit Store: {{ store.name }}</h2>
    {% if error %}
    <div class="alert alert-danger">{{ error }}</div>
    {% endif %}
    {% if success %}
    <div class="alert alert-success">{{ success }}</div>
    {% endif %}
    <form method="POST" action="/stores/{{ store.id }}">
        <div class="form-group">
            <label for="name">Store Name</label>
            <input type="text" id="name" name="name" required value="{{ store.name }}">
        </div>
        <div class="form-group">
            <label for="shopify_domain">Shopify Domain</label>
            <input type="text" id="shopify_domain" name="shopify_domain" required value="{{ store.shopify_domain }}">
        </div>
        <div class="form-group">
            <label for="api_token">Admin API Access Token</label>
            <input type="password" id="api_token" name="api_token" placeholder="Leave empty to keep current">
        </div>
        <div class="form-group">
            <div class="form-check">
                <input type="checkbox" id="is_paused" name="is_paused" value="true" {{ 'checked' if store.is_paused else '' }}>
                <label for="is_paused">Paused (skip during scheduled syncs)</label>
            </div>
        </div>
        <div class="flex gap-2 mt-2">
            <button type="submit" class="btn btn-primary">Save Changes</button>
            <a href="/stores" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>
<div class="card" style="max-width: 600px; margin-top: 20px;">
    <h3 style="font-size: 1em; margin-bottom: 10px;">Store Information</h3>
    <table style="font-size: 14px;">
        <tr><td class="text-muted" style="width: 150px;">Store ID</td><td><code>{{ store.id }}</code></td></tr>
        <tr><td class="text-muted">Created</td><td>{{ store.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</td></tr>
        <tr>
            <td class="text-muted">Last Sync</td>
            <td>
                {% if store.last_sync_at %}
                    {{ store.last_sync_at.strftime('%Y-%m-%d %H:%M:%S') }}
                    {% if store.last_sync_status.value == 'success' %}
                        <span class="badge badge-success">Success</span>
                    {% elif store.last_sync_status.value == 'failed' %}
                        <span class="badge badge-danger">Failed</span>
                    {% endif %}
                {% else %}
                    Never synced
                {% endif %}
            </td>
        </tr>
    </table>
</div>
<div class="card" style="max-width: 600px; margin-top: 20px;">
    <h3 style="font-size: 1em; margin-bottom: 10px; color: #e74c3c;">⚠️ Danger Zone</h3>
    <form method="POST" action="/stores/{{ store.id }}/delete" onsubmit="return confirm('Delete this store?');">
        <button type="submit" class="btn btn-danger">Delete Store</button>
    </form>
</div>
{% endblock %}
